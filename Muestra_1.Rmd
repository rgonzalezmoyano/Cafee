---
title: "Clasificadores de eficiencia"
subtitle: "Diferentes hiperplanos para la clasificiación de la eficiencia"
author: "Ricardo González Moyano & Víctor Javier España Roch"
date: "26 de Septiembre de 2023"
output:
  rmdformats::readthedown:
    embed_resources: true
    standalone: true
    mathjax: true
---

```{r}
devtools::load_all()
```

# Gráfico mejor hiperplano separador
```{r echo=FALSE}
library(ggplot2)
set.seed(314)

# Simulated data
data <- prueba$data

#data$class_efficiency <- ifelse(data$class_efficiency == "efficient", 1, 0)
#data$class_efficiency <- as.factor(data$class_efficiency)

# hiperplano
# make a grid of the predictors
rng.x <- range(prueba$data[1])
rng.y <- range(prueba$data[2])

n_points <- 50
grid <- expand.grid(x1 = seq(rng.x[1], rng.x[2], length = n_points),
                    y = seq(rng.y[1], rng.y[2], length = n_points))

grid$decision <- predict(prueba$final_model, grid, type = "raw")


# Contriur hiperplano
rango_X1 <- range(min(prueba$data[x]), max(prueba$data[x]))

#rango_X2 <- range(0, 5.7)
rango_X2 <- range(min(prueba$data[y]), max(prueba$data[y]))

# Interpolación de puntos
new_x1 <- seq(from = rango_X1[1], to = rango_X1[2], length = 200)
new_x2 <- seq(from = rango_X2[1], to = rango_X2[2], length = 200)
nuevos_puntos <- expand.grid(x1 = new_x1, y = new_x2)

# Predicción según el modelo
predicciones <- predict(object = prueba$final_model, newdata = nuevos_puntos)



ggplot(data = data) +
  geom_point(aes(x = x1, y = y, color = class_efficiency),
               size = 2.5) +
  geom_point(data = grid, aes(x = x1, y = y, color = decision), size = 0.75) +
  theme_bw()
```

